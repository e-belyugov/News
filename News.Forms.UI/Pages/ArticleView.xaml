<views:MvxContentPage x:TypeArguments="viewModels:ArticleViewModel"
    xmlns="http://xamarin.com/schemas/2014/forms" 
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml" 
    xmlns:views="clr-namespace:MvvmCross.Forms.Views;assembly=MvvmCross.Forms"
    xmlns:mvx="clr-namespace:MvvmCross.Forms.Bindings;assembly=MvvmCross.Forms"
    xmlns:viewModels="clr-namespace:News.Core.ViewModels;assembly=News.Core"
    xmlns:helpers="clr-namespace:News.Forms.UI.Helpers"
    x:Class="News.Forms.UI.Pages.ArticleView">

    <ContentPage.Resources>
        <ResourceDictionary>
            <helpers:ByteToImageFieldConverter x:Key="Bic" />
        </ResourceDictionary>

    </ContentPage.Resources>
    <ContentPage.Content>
        <ScrollView>
            <StackLayout Padding="15" BackgroundColor="White">
                <Grid Margin="0, 0, 0, 5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <Label Grid.Column="0" Padding="5" BackgroundColor="LightGray" Text="{Binding Article.TimeStamp, StringFormat=\{0:dd.MM hh:mm\}}"/>
                    <Label Grid.Column="2" Padding="5" BackgroundColor="LightGreen" Text="{Binding Article.SourceTitle}"/>
                </Grid>
                <Label Margin="0,0" FontSize="Large" TextColor="#1976D2" Text="{Binding Article.Title}" VerticalTextAlignment="Center"/>
                <Label Margin="0,0,0,0" TextColor="Black" FontSize="Body" Text="{Binding Article.IntroText}" VerticalTextAlignment="Center"/>
                <Image Source="{Binding Article.Image, TargetNullValue={x:Null}, Converter={StaticResource Bic}}"
                       IsVisible="{Binding Article.Image, Converter={helpers:NullValueBoolConverter}}"
                       HeightRequest="300"
                       Margin="-15, 10, -15, 10"
                       Aspect="AspectFill"
                       HorizontalOptions="FillAndExpand">
                </Image>
                <helpers:ExtendedWebView Margin="-7" VerticalOptions="FillAndExpand" Navigating="ArticleWebView_OnNavigating">
                    <WebView.Source>
                        <HtmlWebViewSource Html="{Binding Article.Text}" />
                    </WebView.Source>
                </helpers:ExtendedWebView>
                <Label Padding="0, 10, 10, 0">
                    <Label.FormattedText>
                        <FormattedString>
                            <Span Text="Ссылка на статью: " />
                            <Span Text="{Binding Article.SourceTitle}"
                                  TextColor="Blue"
                                  TextDecorations="Underline">
                                <Span.GestureRecognizers>
                                    <TapGestureRecognizer Command="{Binding TapCommand}"
                                                          CommandParameter="{Binding Article.SourceLink}" />
                                </Span.GestureRecognizers>
                            </Span>
                        </FormattedString>
                    </Label.FormattedText>
                </Label>
            </StackLayout>
        </ScrollView>
    </ContentPage.Content>
</views:MvxContentPage>
